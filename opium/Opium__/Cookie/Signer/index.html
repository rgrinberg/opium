<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Signer (opium.Opium__.Cookie.Signer)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">opium</a> &#x00BB; <a href="../../index.html">Opium__</a> &#x00BB; <a href="../index.html">Cookie</a> &#x00BB; Signer</nav><h1>Module <code>Cookie.Signer</code></h1><p>Sign an unsign cookies with secret.</p><p>Beware that signing a cookie is not the same as encrypting it! The value of a signed cookie is still visible to anyone, so don't store any sensitive information in it.</p><p>When signing a cookie, a hash of its value is generated using the Signer's secret. The generated string is appended to the Cookie's value. So, for instance, if you have a Cookie <code>key=value</code>, the signed cookie will look like <code>key=value.xRt15vh</code>.</p><p>When reading the cookie value, the hash will be regenerated again and compared with the sent value. If the values are not the same, the cookie has been tempered with, and we discard it.</p><nav class="toc"><ul><li><a href="#constructors">Constructors</a><ul><li><a href="#make"><code>make</code></a></li></ul></li><li><a href="#signing-functions">Signing functions</a><ul><li><a href="#sign"><code>sign</code></a></li><li><a href="#unsign"><code>unsign</code></a></li></ul></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><section><header><h2 id="constructors"><a href="#constructors" class="anchor"></a>Constructors</h2></header><section><header><h4 id="make"><a href="#make" class="anchor"></a><code>make</code></h4></header><dl><dt class="spec value" id="val-make"><a href="#val-make" class="anchor"></a><code><span class="keyword">val</span> make : <span>?&#8288;salt:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make ?salt secret</code> returns a new signer that will sign values with <code>secret</code></p></dd></dl></section></section><section><header><h2 id="signing-functions"><a href="#signing-functions" class="anchor"></a>Signing functions</h2></header><section><header><h4 id="sign"><a href="#sign" class="anchor"></a><code>sign</code></h4></header><dl><dt class="spec value" id="val-sign"><a href="#val-sign" class="anchor"></a><code><span class="keyword">val</span> sign : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>sign signer value</code> signs the string <code>value</code> with <code>signer</code></p></dd></dl></section><section><header><h4 id="unsign"><a href="#unsign" class="anchor"></a><code>unsign</code></h4></header><dl><dt class="spec value" id="val-unsign"><a href="#val-unsign" class="anchor"></a><code><span class="keyword">val</span> unsign : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>unsign signer value</code> unsigns a signed string <code>value</code> with <code>signer</code>.Httpaf</p><p>To avoid time attacks, this function is constant time, it will iterate through all the characters of <code>value</code>, even if it is not the same.</p></dd></dl></section></section></div></body></html>